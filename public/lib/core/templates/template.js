// Generated by CoffeeScript 1.4.0
(function() {

  define(["require", "jquery", "asyngleton"], function(require, $, asyngleton) {
    var Template;
    return Template = (function() {
      /*
      */

      function Template(options) {
        this.options = options;
        this._engine = options.engine;
        this._baseDir = options.directory;
        this.source = options.source;
        this.name = options.name;
      }

      /*
           renders the template with the given options
      */


      Template.prototype.render = function(options, callback) {
        var _this = this;
        this.load(function() {
          return _this._renderer.render(options, callback);
        });
        return this;
      };

      /*
           Loads the template source
      */


      Template.prototype.load = asyngleton(function(callback) {
        var _this = this;
        if (this.source) {
          return callback(null, this.source);
        }
        require(["./engines/" + this._engine], function(engine) {
          return require(["text!" + _this._baseDir + "/" + _this._engine + "/" + _this.name + "." + engine.extension], function(source) {
            _this.source = source;
            _this._renderer = engine.compile(source);
            return callback(null, source);
          });
        });
        return this;
      });

      return Template;

    })();
  });

}).call(this);
