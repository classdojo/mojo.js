// Generated by CoffeeScript 1.6.3
var PaperclipViewDecorator, paperclip, type,
  __bind = function(fn, me){ return function(){ return fn.apply(me, arguments); }; };

paperclip = require("paperclip");

type = require("type-component");

PaperclipViewDecorator = (function() {
  /*
  */

  function PaperclipViewDecorator(view) {
    this.view = view;
    this.remove = __bind(this.remove, this);
    this.render = __bind(this.render, this);
    this._onTemplateChange = __bind(this._onTemplateChange, this);
    if (type(template) !== "function") {
      throw new Error("paper template must be a function for view \"" + this.view.constructor.name + "\"");
    }
    this.view.once("render", this.render);
    this.view.once("remove", this.remove);
    this.view.bind("paper").to(this._onTemplateChange).now();
  }

  /*
  */


  PaperclipViewDecorator.prototype._onTemplateChange = function(template) {
    this.template = paperclip.template(this.template);
    if (this.content) {
      this.content.dispose();
      return this.render();
    }
  };

  /*
  */


  PaperclipViewDecorator.prototype.render = function() {
    this.content = this.template.bind(this.view);
    return this.view.section.append(this.content.section.toFragment());
  };

  /*
  */


  PaperclipViewDecorator.prototype.remove = function() {
    return this.content.unbind();
  };

  /*
  */


  PaperclipViewDecorator.getOptions = function(view) {
    return view.paper;
  };

  PaperclipViewDecorator.decorate = function(view, options) {
    return new PaperclipViewDecorator(view, options);
  };

  return PaperclipViewDecorator;

})();

module.exports = PaperclipViewDecorator;
