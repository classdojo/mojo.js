// Generated by CoffeeScript 1.6.3
var Section, SectionsDecorator, type,
  __bind = function(fn, me){ return function(){ return fn.apply(me, arguments); }; };

Section = require("./section");

type = require("type-component");

SectionsDecorator = (function() {
  /*
  */

  function SectionsDecorator(view, sectionOptions) {
    this.view = view;
    this.sectionOptions = sectionOptions;
    this.render = __bind(this.render, this);
    this.view.set("sections", {});
    this.view.once("render", this.render);
  }

  /*
  */


  SectionsDecorator.prototype.render = function() {
    var sectionName, _results;
    _results = [];
    for (sectionName in this.sectionOptions) {
      _results.push(this._addSection(sectionName, this.sectionOptions[sectionName]));
    }
    return _results;
  };

  /*
  */


  SectionsDecorator.prototype._addSection = function(name, options) {
    var view, viewClass;
    viewClass = this._getSectionClass(options);
    view = new viewClass(options);
    view._parent = this.view;
    this.view.callstack.unshift(view.render);
    return this.view.set("sections." + name, view);
  };

  /*
  */


  SectionsDecorator.prototype._getSectionClass = function(options) {
    if (type(options) === "function") {
      return options;
    } else {
      return this.view.get("models.components." + options.type);
    }
  };

  /*
  */


  SectionsDecorator.getOptions = function(view) {
    return view.sections;
  };

  SectionsDecorator.decorate = function(view, options) {
    return new SectionsDecorator(view, options);
  };

  return SectionsDecorator;

})();

module.exports = SectionsDecorator;
